<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="description"
        content="Theoretical Analysis of Sampling-based MPC and Optimal Covariance Design.">
    <meta name="keywords" content="CoVO, CoVO-MPC, MPC">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>CoVO-MPC: Theoretical Analysis of Sampling-based MPC and Optimal Covariance Design</title>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'G-PYVRSFMDRL');
    </script> -->

    <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">

    <link rel="stylesheet" href="./static/css/bulma.min.css">
    <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
    <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
    <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
    <link rel="stylesheet" href="./static/css/index.css">
    <link rel="icon" href="./static/images/favicon.svg">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script defer src="./static/js/fontawesome.all.min.js"></script>
    <script src="./static/js/bulma-carousel.min.js"></script>
    <script src="./static/js/bulma-slider.min.js"></script>
    <script src="./static/js/index.js"></script>
</head>

<body>

    <!-- <nav class="navbar" role="navigation" aria-label="main navigation">
        <div class="navbar-brand">
            <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
            </a>
        </div>
        <div class="navbar-menu">
            <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
                <a class="navbar-item" href="https://keunhong.com">
                    <span class="icon">
                        <i class="fas fa-home"></i>
                    </span>
                </a>

                <div class="navbar-item has-dropdown is-hoverable">
                    <a class="navbar-link">
                        More Research
                    </a>
                    <div class="navbar-dropdown">
                        <a class="navbar-item" href="https://hypernerf.github.io">
                            HyperNeRF
                        </a>
                        <a class="navbar-item" href="https://nerfies.github.io">
                            Nerfies
                        </a>
                        <a class="navbar-item" href="https://latentfusion.github.io">
                            LatentFusion
                        </a>
                        <a class="navbar-item" href="https://photoshape.github.io">
                            PhotoShape
                        </a>
                    </div>
                </div>
            </div>

        </div>
    </nav> -->

    <section class="hero">
        <div class="hero-body">
            <div class="container is-max-desktop">
                <div class="columns is-centered">
                    <div class="column has-text-centered">
                        <h1 class="title is-1 publication-title">CoVO-MPC: Theoretical Analysis of Sampling-based MPC
                            and Optimal Covariance Design</h1>
                        <div class="is-size-5 publication-authors">
                            <span class="author-block">
                                <a href="https://iscoyizj.github.io">Zeji Yi</a><sup>*</sup>,
                            </span>
                            <span class="author-block">
                                <a href="https://panchaoyi.com">Chaoyi Pan</a><sup>*</sup>,
                            </span>
                            <span class="author-block">
                                <a href="https://guanqihe.github.io">Guanqi He</a>,
                            </span>
                            <span class="author-block">
                                <a href="https://www.guannanqu.com">Guannan Qu</a>,
                            </span>
                            <span class="author-block">
                                <a href="http://www.gshi.me/">Guanya Shi</a>,
                            </span>
                        </div>

                        <div class="is-size-5 publication-authors">
                            <span class="author-block">Carnegie Mellon University</span>
                        </div>

                        <div class="column has-text-centered">
                            <div class="publication-links">
                                <!-- PDF Link. -->
                                <span class="link-block">
                                    <a href="https://drive.google.com/file/d/1u964n8BeQnZhwXpms7hJx8DNDYjwxTxy/view?usp=share_link"
                                        class="external-link button is-normal is-rounded is-dark">
                                        <span class="icon">
                                            <i class="fas fa-file-pdf"></i>
                                        </span>
                                        <span>Paper</span>
                                    </a>
                                </span>
                                <!-- <span class="link-block">
                                    <a href="https://arxiv.org"
                                        class="external-link button is-normal is-rounded is-dark">
                                        <span class="icon">
                                            <i class="ai ai-arxiv"></i>
                                        </span>
                                        <span>arXiv</span>
                                    </a>
                                </span> -->
                                <!-- Video Link. -->
                                <!-- <span class="link-block">
                                    <a href="https://www.youtube.com/watch?v=MrKrnHhk8IA"
                                        class="external-link button is-normal is-rounded is-dark">
                                        <span class="icon">
                                            <i class="fab fa-youtube"></i>
                                        </span>
                                        <span>Video</span>
                                    </a>
                                </span> -->
                                <!-- Code Link. -->
                                <span class="link-block">
                                    <a href="https://github.com/LeCAR-Lab/quadjax"
                                        class="external-link button is-normal is-rounded is-dark">
                                        <span class="icon">
                                            <i class="fab fa-github"></i>
                                        </span>
                                        <span>Code</span>
                                    </a>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="hero teaser">
        <div class="container is-max-desktop">
            <div class="content has-text-centered">
                <video id="teaser" autoplay muted loop playsinline width="40%">
                    <source src="./static/videos/long-exp.mov" type="video/mp4">
                </video>
                <p>
                    CoVO-MPC significantly outperforms MPPI by optimizing the sampling covariance.
                </p>
            </div>
        </div>
    </section>


    <!-- <section class="hero is-light is-small">
  <div class="hero-body">
    <div class="container">
      <div id="results-carousel" class="carousel results-carousel">
        <div class="item item-steve">
          <video poster="" id="steve" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/steve.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-chair-tp">
          <video poster="" id="chair-tp" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/chair-tp.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-shiba">
          <video poster="" id="shiba" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/shiba.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-fullbody">
          <video poster="" id="fullbody" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/fullbody.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-blueshirt">
          <video poster="" id="blueshirt" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/blueshirt.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-mask">
          <video poster="" id="mask" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/mask.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-coffee">
          <video poster="" id="coffee" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/coffee.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-toby">
          <video poster="" id="toby" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/toby2.mp4"
                    type="video/mp4">
          </video>
        </div>
      </div>
    </div>
  </div>
</section> -->


    <section class="section">
        <div class="container is-max-desktop">
            <!-- Abstract. -->
            <div class="columns is-centered has-text-centered">
                <div class="column is-four-fifths">
                    <h2 class="title is-3">Abstract</h2>
                    <div class="content has-text-justified">
                        <p>
                            Sampling-based Model Predictive Control (MPC) has been a practical and effective approach in
                            many domains, especially in model-based reinforcement learning, thanks to its flexibility
                            and parallelizability. Despite its appealing empirical performance, the theoretical
                            understanding, particularly in terms of convergence analysis and hyperparameter tuning,
                            remains absent.
                        </p>
                        <!-- insert two image colomns here side by side -->
                        <p>
                            In this paper, we precisely characterize the convergence property of a widely used
                            sampling-based MPC method, Model Predictive Path Integral Control (MPPI). We show that
                            MPPI
                            enjoys at least linear convergence rates when the optimization problem is quadratic. We
                            then
                            extend to three non-quadratic settings, including general systems. Our theoretical
                            analysis
                            directly leads to a novel sampling-based MPC algorithm, CoVariance-Optimal MPC
                            (CoVO-MPC)
                            that optimally schedules the sampling covariance. Empirically, CoVO-MPC significantly
                            outperforms standard MPPI by <b>43-54%</b> from simulations to real-world quadrotor
                            agile control
                            tasks.
                        </p>
                    </div>
                </div>
            </div>
            <!--/ Abstract. -->

            <!-- Paper video. -->
            <!-- <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Video</h2>
        <div class="publication-video">
          <iframe src="https://www.youtube.com/embed/MrKrnHhk8IA?rel=0&amp;showinfo=0"
                  frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
        </div>
      </div>
    </div> -->
            <!--/ Paper video. -->
        </div>
    </section>


    <section class="section">
        <div class="container is-max-desktop">
            <div class="columns is-centered">
                <div class="column">
                    <div class="content">
                        <h2 class="title is-3">Motivation: sampling-based MPC lacks of
                            theoretical understanding</h2>
                        <p>
                            Sampling-based MPC becomes prevalent in motion planning and model-based RL for its
                            flexibility and parallizability.
                        </p>
                        <p>
                            The following figure shows different sampling strategy of CoVO-MPC and MPPI controlling a 2d
                            drone. Both algorithm do a receding-horizon control by sampling trajectories (the green
                            area) at each time step.
                        </p>
                        <p>
                            However, there is <b>no convergence analysis</b> to it, which leads to tune hyperparameters
                            heuristically. For instance, MPPI use dynamic-agnostic isotropic Gaussian to sample
                            trajectories, which leads to sub-optimal performance.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="section">
        <div class="container is-max-desktop">
            <div class="columns is-centered">
                <div class="column">
                    <div class="content">
                        <img src="./static/images/mppi_vis.gif">
                        <p>
                            MPPI: sampling with isotropic Gaussian, cannot track the trajectory very well.
                        </p>
                    </div>
                </div>
                <div class="column">
                    <div class="content">
                        <img src="./static/images/covo_vis.gif">
                        <p>
                            CoVO-MPC: sampling with optimized covariance matrix, better tracking performance.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="section">
        <div class="container is-max-desktop">
            <div class="columns is-centered">
                <div class="column">
                    <div class="content">
                        <h2 class="title is-3">Contribution: first convergence analysis and optimal covariance design
                            algorithm</h2>
                        <p>
                            We first proves MPPI’s convergence and provide insights into optimal sampling covariance
                            design. CoVO-MPC is proposed to optimize sampling covariance according to the optimization
                            landscape.
                        </p>
                        <div style="display: block; margin-left: auto; margin-right: auto; width: 80%;">
                            <img src="./static/images/algo.png" width="100%">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="section">
        <div class="container is-max-desktop">
            <div class="columns is-centered">
                <div class="column">
                    <div class="content">
                        <h2 class="title is-3">Performance: CoVO-MPC demonstrate better performance in both sim and real
                        </h2>
                        <p>
                            We evaluated our algorithm in three environment:
                        </p>
                        <div style="display: block; margin-left: auto; margin-right: auto; width: 50%;">
                            <img src="./static/images/envs.png" width="100%">
                        </div>
                        <p>
                            The evaluated cost of CoVO-MPC is 43-54% lower than MPPI.
                        </p>
                        <div style="display: block; margin-left: auto; margin-right: auto; width: 80%;">
                            <img src="./static/images/performance.png" width="100%">
                        </div>
                        <p>
                            The following picture shows the trajectory of CoVO-MPC and MPPI in the real world:
                        </p>
                        <div style="display: block; margin-left: auto; margin-right: auto; width: 60%;">
                            <img src="./static/images/realworld_traj.png" width="100%">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="section">
        <div class="container is-max-desktop">
            <div class="columns is-centered">
                <div class="column">
                    <div class="content">
                        <h2 class="title is-3">How it works: CoVO-MPC samples lower-cost trajectory by a optimized
                            covariance matrix</h2>
                        <p>
                            CoVO-MPC optimized the sampling covariance matrix to sample better trajectories, which
                            contribute to higher sample efficiency and performance.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="section">
        <div class="container is-max-desktop">
            <div class="columns is-centered">
                <div class="column">
                    <div class="content">
                        <img src="./static/images/mat_diff.png" width="65%">
                        <p>
                            Difference between covariance matrix optimized by CoVO v.s. MPPI.
                        </p>
                    </div>
                </div>
                <div class="column">
                    <div class="content">
                        <img src="./static/images/cost_single_step.png">
                        <p>
                            Our sampling strategy generate to lower-cost trajectories.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>


    <section class="section" id="BibTeX">
        <div class="container is-max-desktop content">
            <h2 class="title">BibTeX</h2>
            <pre><code></code></pre>
        </div>
    </section>


    <footer class="footer">
        <div class="container">
            <div class="columns is-centered">
                <div class="column is-8">
                    <div class="content">
                        <p>
                            Template comes from  
                            <a href="https://github.com/nerfies/nerfies.github.io">nerfies</a>. 
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </footer>

</body>

</html>
